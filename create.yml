---

- name: MasterVM
  hosts:
    - 127.0.0.1
  vars:
    auth_url: "{{ lookup('env','OS_AUTH_URL') }}"
    login_username: "{{ lookup('env','OS_USERNAME') }}"
    login_password: "{{ lookup('env','OS_PASSWORD') }}"
    login_tenant_name: "{{ lookup('env','OS_TENANT_NAME') }}"
    #login_tenant_name: "VTS000009"
    image_id: "7a7af5bf-a86b-4b9e-8ad5-c4e4b1381991"
    availability_zone: "us-west-3a"
    key_name: "cona_admin"
    host_name: "A0CBUS034XHD00"
    private_net: "cona-network1"
    flavor_ram: "32"
  tasks:
   - name: Install
     os_server:
      auth:
        auth_url: "{{ auth_url }}"
      security_groups: "default"
      state: present
      availability_zone: "{{ availability_zone }}"
      name: "{{ host_name }}"
      image: "{{ image_id }}"
      key_name: "{{ key_name }}"
      timeout: 500
      nics:
        - net-name: "{{ private_net }}"
      flavor_ram: "{{ flavor_ram }}"
      meta:
        hostname: "{{ host_name }}"
        group: hadoop
